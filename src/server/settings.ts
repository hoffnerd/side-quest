"use server";

// Types ----------------------------------------------------------------------------
// Packages -------------------------------------------------------------------------
import { revalidatePath } from "next/cache";
import { redirect } from "next/navigation";
// Server ---------------------------------------------------------------------------
import { db } from "./db";
import { serverAction } from "@/_legoBlocks/nextjsCommon/server/actions";
// Data -----------------------------------------------------------------------------
// Stores ---------------------------------------------------------------------------
// Hooks ----------------------------------------------------------------------------
// Components -----------------------------------------------------------------------
// Other ----------------------------------------------------------------------------



//______________________________________________________________________________________
// ===== Types =====



//______________________________________________________________________________________
// ===== True Constants =====



//______________________________________________________________________________________
// ===== Actions =====

export const updateSettings = async (formData: FormData) => {
    await serverAction<Boolean>(async ({ session }) => {
        await db.user.update({ 
            where: { id: session.user.id },
            data: { username: `${formData.get("username") ?? ""}` }
        });
        revalidatePath("/settings");
        return true;
    }, { trace: "updateSettings" });

    redirect("/settings");
}
